name: 'Pack NuGet'
author: 'Jiri Polasek'
description: >-
  Determine version suffix from tag/branch and pack the project into artifacts/.
  
inputs:
  projectPath:
    description: "Path to the project file (e.g. src/ProjectName.csproj)"
    required: true
  event_name:
    description: "github.event_name (push, workflow_dispatch, etc.)"
    required: true
  ref:
    description: "github.ref (e.g. refs/heads/feature/123-issue-desc)"
    required: true
  version:
    description: "Manual version override (only for workflow_dispatch)"
    required: false
    default: ""
  workspace:
    description: "github.workspace (path to repo root)"
    required: true
  configuration:
    description: "Build configuration (e.g. Release, Debug)"
    default: "Release"

runs:
  using: "composite"
  steps:
    - name: Pack
      shell: pwsh
      run: |
        $actionDir = "${{ github.action_path }}"
        pwsh "$actionDir/pack.ps1" `
          -ProjectPath     '${{ inputs.projectPath }}' `
          -GitHubEventName '${{ inputs.event_name }}' `
          -GitHubRef       '${{ inputs.ref }}' `
          -InputsVersion   '${{ inputs.version }}' `
          -Workspace       '${{ inputs.workspace }}' `
          -Configuration   '${{ inputs.configuration }}'